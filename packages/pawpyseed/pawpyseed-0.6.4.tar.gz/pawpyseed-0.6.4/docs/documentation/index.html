<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>PAWpySeed: pawpyseed</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PAWpySeed
   </div>
   <div id="projectbrief">Parallel C/Python package for numerical analysis of PAW DFT wavefunctions</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">pawpyseed </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://kylebystrom.github.io/pawpyseed/">https://kylebystrom.github.io/pawpyseed/</a> <br />
</p>
<p>PAWpySeed is a parallelized Python and C tool for reading and analyzing the optimized band structure and wave functions of VASP DFT calculations. The code is written for the PAW formalism developed by P.E. Blochl and implemented in VASP.</p>
<h2>Installation</h2>
<p>TO compile the C code, pawpyseed needs to link with the Intel Math Kernel Library (MKL). You can customize how this is done via the config file (see "The customizable way"). However, for most users, the easy way described below is adequate.</p>
<h3>The easy way</h3>
<p>First, install <code>mkl-devel</code> in your local installation:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;pip install mkl-devel --user</div></div><!-- fragment --><p>Next, find your Python installation directory (call it <code>INST_DIR</code>) and add the <code>include</code> and <code>lib</code> to your C compiler paths to link with MKL: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;export C_INCLUDE_PATH=$INST_DIR/include:$C_INCLUDE_PATH</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;export LIBRARY_PATH=$INST_DIR/lib:$LIBRARY_PATH</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;export LD_LIBRARY_PATH=$INST_DIR/lib:$LD_LIBRARY_PATH</div></div><!-- fragment --><p>Then run </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;python setup.py build</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;python setup.py install</div></div><!-- fragment --><p>OR with <code>pip</code>.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;pip install pawpyseed</div></div><!-- fragment --><p>This has been tested on Scientific Linux 7 and Linux Mint 18, but should work for systems that have the appropriate packages and environment variables defined as described below.</p>
<h4>Simple site.cfg approach</h4>
<p>After installing MKL locally with <code>pip</code>, copy <code>site.cfg.default</code> from the pawpyseed repository to <code>~/.pawpyseed-site.cfg</code>. Open it and set <code>root=&lt;your home directory&gt;/.local</code> under the <code>[mkl]</code> heading and uncomment it by removing the <code>#</code>.</p>
<p>IF you get linking issues at runtime using this method, try setting <code>sdl=True</code> in the config file and then setting the environment variable <code>MKL_THREADING_LAYER=sequential</code>.</p>
<h4>Intel easy way</h4>
<p>If you have <code>icc</code> and prefer to use it to compile pawpyseed's C libraries, set <code>compiler=icc</code> in <code>~/.pawpyseed-site.cfg</code> and then set <code>root</code> to your MKL installation directory. Set <code>sdl=True</code>. You MKL distribution must have also been compiled with the Intel compiler. Run the <code>setup.py</code> script or <code>pip install pawpyseed</code>.</p>
<h3>The customizable way</h3>
<p>To make your own config file, make a file in your home directory <code>~</code> named <code>.pawpyseed-site.cfg</code>. This file allows you to customize configuration settings for pawpyseed. It is read using the Python configparser module <a href="https://docs.python.org/3/library/configparser.html">https://docs.python.org/3/library/configparser.html</a>. If you don't want to learn about the configuration file options, skip to "The Easy Way" to get this done with quickly. The options (with their defaults) are as follows:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;[compiler]</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;# Name of the compiler to be used. By default, let&#39;s the setup script choose this.</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;compiler_name = &lt;no default&gt; # Examples: icc or gcc</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;# Name of the linker to be used. By default, let&#39;s the setup script choose this.</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;# NOTE: Don&#39;t forget the -shared tag for icc or gcc!</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;# NOTE: If compiler_name is set and linker_name is not,</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;#       linker_name is set to compiler_name with the -shared tag appended.</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;linker_name = &lt;no default&gt; # Examples: icc -shared or gcc -shared</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;[mkl]</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;# MKL installation directory. &lt;root&gt;/lib or &lt;root&gt;/lib/intel64 must contain</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;# the MKL shared object libraries, while &lt;root&gt;/include must containn the MKL headers.</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;# Many systems have the environment variable</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;# MKLROOT set for this, so you can set this to the output of:</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;#       echo $MKLROOT</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;# If you pip install mkl-devel, this goes to /usr or /usr/local.</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;# If you pip install mkl-devel --user, this goes to ~/.local</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;# (or the equivalents for your system).</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;root = &lt;no default&gt;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;# Don&#39;t change this. Might be used in the future but currently has no effect.</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;interface32 = True</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;# Whether to compile with the single dynamic library libmkl_rt.so.</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;# If you are having installation/performance problems, try setting sdl=True,</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;# pip installing mkl-devel with the --user option, set root=~/.local,</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;# and set the environment variable MKL_THREADING_LAYER=sequential</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;# when using pawpyseed.</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;sdl = False</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;[threading]</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;# Whether to use omp_loops. If False, pawpyseed doesn&#39;t do any parallelization</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;# on its own, though its calls to MKL, BLAS, LAPACK, etc might be</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;# threaded by MKL.</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;omp_loops = True</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;# Whether to use threading for MKL. OVERRIDDEN if sdl=True, in which case</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;# MKL is threaded by default and you can run sequentially by</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;# setting the environment variable MKL_THREADING_LAYER=sequential</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;# when using pawpyseed.</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;# NOTE: ONLY SET THIS TRUE IF COMPILING WITH icc (OR gcc with omp_loops=False),</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;# and only if you are very concerned about speed. This is because gcc</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;# cannot do nested parallelism with MKL</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;threaded_mkl = False</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;# NOTE: Do not link to icc-compiled MKL libraries when compiling the C</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;# extension with gcc or vice versa. Use like type compilers.</div></div><!-- fragment --><h3>Dependencies</h3>
<p>All dependencies indicate the minimum version tested. PAWpySeed might work fine with earlier versions, but use of older versions will not be officially supported.</p>
<p>Python requirements: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Python&gt;=3.5</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;numpy&gt;=1.14</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;scipy&gt;=1.0</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;pymatgen&gt;=2018.2.13</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;sympy&gt;=1.1.1</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;matplotlib&gt;=0.2.5</div></div><!-- fragment --><p>C requirements: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;icc &gt;= 16.0.4 OR gcc &gt;= 4.8.5</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Intel Math Kernel Library &gt;= 11.3.4</div></div><!-- fragment --><p> If you don't want to <code>pip install</code> Intel MKL, it is available for free installation on a variety of platforms. Most computing clusters will have Intel MKL, and you can install it on your desktop (or any system to which you have root access) by following the relevant instructions at the following URL: <a href="https://software.intel.com/en-us/articles/free-ipsxe-tools-and-libraries">https://software.intel.com/en-us/articles/free-ipsxe-tools-and-libraries</a>.</p>
<h2>Theory and Input</h2>
<h3>PAW</h3>
<p>The projector augmented wave (PAW) method is a technique used in plane wave density functional theory to simplify the description of the wavefunctions near the nuclei of a system. The strong Coulombic forces near an atomic nucleus creates quickly oscillating wavefunctions that are not well described by plane waves without prohibitively large basis sets, so a "pseudopotential" is introduced near the atomic nuclei which results in smooth "pseudo wavefunctions" well described by plane waves. The full wavefunctions can be recovered by a linear transform of the pseudowavefunctions. The PAW method requires three sets of functions: projector functions, onto which pseudowavefunctions are projected to probe their character; full partial waves, which describe atomic valence states derived from the true potential; and pseudo partial waves, which are derived from the full partial waves and pseudopotential.</p>
<h3>Files</h3>
<p>The projector functions and partial waves are unique to each element and stored in the POTCAR file used in a VASP calculation. The pseudowavefunction is the part of the wavefunction optimized during a DFT calculation and is stored in the WAVECAR output file in VASP. PAWpySeed parses both files to retrieve all parts of the full Kohn Sham wavefunctions.</p>
<h2>The Code</h2>
<p>The main purpose of PAWpySeed is to evaluate overlap operators between Kohn-Sham wavefunctions from different structures, which is not done by standard plane-wave DFT codes. Such functionality can be useful for analyzing the composition of defect levels in solids, which is main application for which the code is currently focused.</p>
<h3>Implementation</h3>
<ul>
<li>Python Interface</li>
<li>Computationally intensive tasks in C</li>
<li>Parallelized with openmp</li>
</ul>
<h3>Current Functionality</h3>
<ul>
<li>Read pseudowavefunctions</li>
<li>Read projectors and partial waves from VASP POTCAR</li>
<li>Evaluate overlap operators between bands, including when bands belong to different structures with the same lattice</li>
<li>Project point defect levels onto bulk valence and conduction bands</li>
<li>Convenient pycdt interface</li>
<li>Perturbation-extrapolation correction for point defect calculations</li>
<li>Read noncollinear pseudo wavefunctions and construct all-electron wavefunctions (no overlap operator evaluation for noncollinear data)</li>
<li>Calculate plane-wave matrix elements between bands.</li>
</ul>
<h2>Acknowledgments</h2>
<p>The code in PAWpySeed is based on a several algorithms and codes, which are enumerated here.</p>
<ol type="1">
<li><b>PAW</b>: The PAW method was developed by P. E. Blochl in 1994. His paper deriving the method was helpful to me in deriving the extensions to the formalism needed to develop this code.<ul>
<li>P. E. Blochl. Projector augmented-wave method. Phys. Rev. B, 50:17953, 1994.</li>
</ul>
</li>
<li><b>VASP</b>: PAWpySeed is primarily built to read and process the output of VASP calculations. PAWpySeed reads PAW wavefunctions and calculate overlap operators using algorithms derived from VASP and other plane-wave codes, so the following citations are necessary. The last citation is specifically for the PAW method and potentials. See the VASP website at <a href="http://community.hartree.stfc.ac.uk/wiki/site/admin/vasp.html">http://community.hartree.stfc.ac.uk/wiki/site/admin/vasp.html</a> for information on citing specific functionals.<ul>
<li>G. Kresse and J. Hafner. Ab initio molecular dynamics for liquid metals. Phys. Rev. B, 47:558, 1993.</li>
<li>G. Kresse and J. Hafner. Ab initio molecular-dynamics simulation of the liquid-metal-amorphous-semiconductor transition in germanium. Phys. Rev. B, 49:14251, 1994.</li>
<li>G. Kresse and J. Furthmüller. Efficiency of ab-initio total energy calculations for metals and semiconductors using a plane-wave basis set. Comput. Mat. Sci., 6:15, 1996.</li>
<li>G. Kresse and J. Furthmüller. Efficient iterative schemes for ab initio total-energy calculations using a plane-wave basis set. Phys. Rev. B, 54:11169, 1996.</li>
<li>G. Kresse and D. Joubert. From ultrasoft pseudopotentials to the projector augmented-wave method. Phys. Rev. B, 59:1758, 1999.</li>
</ul>
</li>
<li><b>NUMSBT</b>: NUMSBT is a code written by J. D. Talman, which implements an algorithm that calculates the spherical Bessel transform (SBT) in O(NlogN) time. PAWpySeed employs the high-k transform algorithm implemented in NUMSBT to calculate the overlap operators between overlapping augmentation spheres that have different positions or elements. It is also used to filter out high-frequency components from AE partial waves, which allows projections from pseudowavefunctions to AE partial waves to be performed in real space, which is a vital component of the code. NUMSBT is distributed under the Standard CPC License, and the algorithm is developed in the following paper:<ul>
<li>Talman, J. Computer Physics Communications 2009, 180, 332 –338.</li>
</ul>
</li>
<li><b>WaveTrans</b>: reader.c and <a class="el" href="reader_8h.html">reader.h</a>, which read WAVECAR files from VASP output, are based on the Fortran program, WaveTrans, written by R. M. Feenstra and M. Widom from the Dept. of Physics at Carnegie Mellon University. To see the original work, please visit <a href="https://www.andrew.cmu.edu/user/feenstra/wavetrans/">https://www.andrew.cmu.edu/user/feenstra/wavetrans/</a>.</li>
<li><b>Doxygen</b>: Doxygen is a documentation generator from which I built the docs for PAWpySeed. It is an excellent tool that allows for clean, up-to-date documentaton that is easy to make and navigate. Check it out at <a href="http://www.stack.nl/~dimitri/doxygen/">http://www.stack.nl/~dimitri/doxygen/</a>.</li>
</ol>
<h2>Citing</h2>
<p>If you find pawpyseed useful, please encourage its development by citing the following paper in your research:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;@ARTICLE{2019arXiv190411572B,</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;       author = { {Bystrom}, Kyle and {Broberg}, Danny and {Dwaraknath}, Shyam and</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;         {Persson}, Kristin A. and {Asta}, Mark},</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        title = &quot;{Pawpyseed: Perturbation-extrapolation band shifting corrections for point defect calculations}&quot;,</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;      journal = {arXiv e-prints},</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;     keywords = {Condensed Matter - Materials Science},</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;         year = &quot;2019&quot;,</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;        month = &quot;Apr&quot;,</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;          eid = {arXiv:1904.11572},</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;        pages = {arXiv:1904.11572},</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;archivePrefix = {arXiv},</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;       eprint = {1904.11572},</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; primaryClass = {cond-mat.mtrl-sci},</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;       adsurl = {https://ui.adsabs.harvard.edu/abs/2019arXiv190411572B},</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;      adsnote = {Provided by the SAO/NASA Astrophysics Data System}</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;}</div></div><!-- fragment --><p>You can view the paper here: <a href="https://arxiv.org/abs/1904.11572">https://arxiv.org/abs/1904.11572</a></p>
<h2>Questions and Comments</h2>
<p>Find a bug? Areas of code unclearly documented? Other questions? Feel free to contact Kyle Bystrom at <a href="#" onclick="location.href='mai'+'lto:'+'kyl'+'eb'+'yst'+'ro'+'m@g'+'ma'+'il.'+'co'+'m'; return false;">kyleb<span style="display: none;">.nosp@m.</span>ystr<span style="display: none;">.nosp@m.</span>om@gm<span style="display: none;">.nosp@m.</span>ail.<span style="display: none;">.nosp@m.</span>com</a> with the subject "pawpyseed: (Your Topic)" AND/OR create an issue on the Github page at <a href="https://github.com/kylebystrom/pawpyseed">https://github.com/kylebystrom/pawpyseed</a>. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
