function h(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);r&&(e=e.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,e)}return n}function u(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?h(Object(n),!0).forEach(function(e){y(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function y(t,r,n){return r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function O(t,r){if(t==null)return{};var n=w(t,r),e,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++){if(e=o[i],r.indexOf(e)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(t,e))continue;n[e]=t[e]}}return n}function w(t,r){if(t==null)return{};var n={},e=Object.keys(t),i,o;for(o=0;o<e.length;o++){if(i=e[o],r.indexOf(i)>=0)continue;n[i]=t[i]}return n}import{useEffect as c,useMemo as v}from"../../web_modules/react.js";import m from"../utils/event.js";import{toast as d}from"../../web_modules/react-toastify.js";import I from"../../web_modules/swr.js";function b(t,r,n){const e=I(t,r,n),{data:i,error:o}=e,s=O(e,["data","error"]),a=v(()=>!!t&&i===void 0&&!o,[t,i,o]);return c(()=>{o&&d(o.message,{position:d.POSITION.TOP_CENTER,type:d.TYPE.ERROR})},[o]),u({data:i,error:o,loading:a},s)}function g(t,r,n,e){const i=v(()=>{var l,f,p;return u(u({},e),{},{refreshInterval:r?(l=e==null?void 0:e.refreshInterval)!==null&&l!==void 0?l:15*1e3:0,dedupingInterval:(f=e==null?void 0:e.refreshInterval)!==null&&f!==void 0?f:15*1e3,errorRetryInterval:(p=e==null?void 0:e.refreshInterval)!==null&&p!==void 0?p:15*1e3})},[r,e]),o=b(t,n,i),{mutate:s}=o,a=O(o,["mutate"]);return c(()=>{r&&s()},[r,s]),c(()=>(m.on("refresh",s),()=>{m.off("refresh",s)}),[s]),u({mutate:s},a)}export default b;export{g as useRunningRequest};
