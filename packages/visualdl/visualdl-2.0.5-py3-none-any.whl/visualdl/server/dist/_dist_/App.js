const m={};import P from"../__snowpack__/env.js";m.env=P;import e,{Suspense as U,useCallback as b,useEffect as a,useMemo as v,useState as j}from"../web_modules/react.js";import{Redirect as y,Route as c,BrowserRouter as L,Switch as I,useLocation as S}from"../web_modules/react-router-dom.js";import{THEME as A,matchMedia as d}from"./utils/theme.js";import{headerHeight as u,position as N,size as C,zIndexes as T}from"./utils/style.js";import x from"./components/BodyLoading.js";import B from"./components/ErrorBoundary.js";import p from"./pages/error.js";import{Helmet as O}from"../web_modules/react-helmet.js";import E from"../web_modules/nprogress.js";import H from"./components/Navbar.js";import{SWRConfig as k}from"../web_modules/swr.js";import{ToastContainer as W}from"../web_modules/react-toastify.js";import{actions as D}from"./store/index.js";import{fetcher as M}from"./utils/fetch.js";import K from"../web_modules/@visualdl/wasm.js";import f from"./routes/index.js";import h from"../web_modules/styled-components.js";import{useDispatch as V}from"../web_modules/react-redux.js";import{useTranslation as z}from"../web_modules/react-i18next.js";const g=m.env.SNOWPACK_PUBLIC_BASE_URI,F=m.env.SNOWPACK_PUBLIC_PATH,Y=h.main.withConfig({displayName:"App__Main",componentId:"n063fb-0"})(["padding-top:",";"],u),$=h.header.withConfig({displayName:"App__Header",componentId:"n063fb-1"})(["z-index:",";"," ",""],T.header,C(u,"100%"),N("fixed",0,0,null,0)),l=f.find(t=>t.default),q=f.reduce((t,r)=>(r.children?t.push(...r.children):t.push(r),t),[]),G=()=>(a(()=>(E.start(),()=>{E.done()}),[]),null),J=()=>{const t=S();return a(()=>{window._hmt.push(["_trackPageview",g+t.pathname])},[t.pathname]),null},Q=()=>{var t;const{t:r,i18n:n}=z("errors"),R=v(()=>n.language?n.dir(n.language):"",[n]),[s,w]=j(!1);a(()=>{(async()=>{s||(await K(`${F}/wasm/visualdl.wasm`),w(!0))})()},[s]);const _=V(),i=b(o=>_(D.theme.setTheme(o.matches?"dark":"light")),[_]);return a(()=>{if(!A)return d.addEventListener("change",i),()=>{d.removeEventListener("change",i)}},[i]),e.createElement("div",{className:"app"},e.createElement(O,{defaultTitle:"VisualDL",titleTemplate:"%s - VisualDL"},e.createElement("html",{lang:n.language,dir:R})),e.createElement(k,{value:{fetcher:M,revalidateOnFocus:!1,revalidateOnReconnect:!1}},s?e.createElement(Y,null,e.createElement(L,{basename:g||"/"},e.createElement(J,null),e.createElement($,null,e.createElement(H,null)),e.createElement(B,{fallback:e.createElement(p,null)},e.createElement(U,{fallback:e.createElement(G,null)},e.createElement(I,null,e.createElement(y,{exact:!0,from:"/",to:(t=l==null?void 0:l.path)!==null&&t!==void 0?t:"/index"}),q.map(o=>e.createElement(c,{key:o.id,path:o.path,component:o.component})),e.createElement(c,{path:"*"},e.createElement(p,{title:r("errors:page-not-found")}))))))):e.createElement(x,null),e.createElement(W,null)))};export default Q;
