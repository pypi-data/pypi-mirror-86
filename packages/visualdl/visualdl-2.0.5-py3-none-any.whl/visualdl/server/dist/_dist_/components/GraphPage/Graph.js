const W={};import K from"../../../__snowpack__/env.js";W.env=K;import i,{useCallback as P,useEffect as s,useImperativeHandle as F,useMemo as V,useRef as Y,useState as C}from"../../../web_modules/react.js";import{contentHeight as q,position as M,primaryColor as D,rem as a,size as R,transitionProps as T}from"../../utils/style.js";import J from"../ChartToolbox.js";import Q from"../../../web_modules/react-spinners/HashLoader.js";import S from"../../assets/images/netron.png.proxy.js";import l from"../../../web_modules/styled-components.js";import{toast as X}from"../../../web_modules/react-toastify.js";import Z from"../../hooks/useTheme.js";import{useTranslation as ee}from"../../../web_modules/react-i18next.js";const _=W.env.SNOWPACK_PUBLIC_PATH;let A=`${window.location.protocol}//${window.location.host}`;if(_.startsWith("http")){const r=new URL(_);A=`${r.protocol}//${r.host}`}const H=a(40),te=l.div.withConfig({displayName:"Graph__Wrapper",componentId:"ojmbku-0"})(["position:relative;height:",";background-color:var(--background-color);display:flex;flex-direction:column;justify-content:center;align-items:center;",""],q,T("background-color")),oe=l.div.withConfig({displayName:"Graph__RenderContent",componentId:"ojmbku-1"})(["position:absolute;top:0;left:0;"," opacity:",";z-index:",";pointer-events:",";"],R("100%","100%"),r=>r.show?1:0,r=>r.show?0:-1,r=>r.show?"auto":"none"),re=l(J).withConfig({displayName:"Graph__Toolbox",componentId:"ojmbku-2"})(["height:",";border-bottom:1px solid var(--border-color);padding:0 ",";",""],H,a(20),T("border-color")),ne=l.div.withConfig({displayName:"Graph__Content",componentId:"ojmbku-3"})(["position:relative;height:calc(100% - ",");> iframe{"," border:none;}> .powered-by{display:block;"," color:var(--graph-copyright-color);font-size:",";user-select:none;img{height:1em;filter:var(--graph-copyright-logo-filter);vertical-align:middle;}}"],H,R("100%","100%"),M("absolute",null,null,a(20),a(30)),a(14)),ie=l.div.withConfig({displayName:"Graph__Loading",componentId:"ojmbku-4"})([""," display:flex;flex-direction:column;justify-content:center;align-items:center;overscroll-behavior:none;cursor:progress;font-size:",";line-height:",";"],R("100%","100%"),a(16),a(60)),N=i.forwardRef(({files:r,uploader:x,showAttributes:L,showInitializers:j,showNames:I,horizontal:k,onRendered:c,onOpened:d,onSearch:m,onShowModelProperties:u,onShowNodeProperties:p,onShowNodeDocumentation:h},G)=>{const{t:f}=ee("graph"),U=Z(),[t,$]=C(!1),[v,g]=C(!1),[b,B]=C(!1),z=Y(null),y=P(o=>{if(o.data){const{type:w,data:n}=o.data;switch(w){case"status":switch(n){case"ready":return $(!0);case"loading":return g(!0);case"rendered":g(!1),B(!0),c==null||c();return}return;case"opened":return d==null?void 0:d(n);case"search":return m==null?void 0:m(n);case"cancel":return g(!1);case"error":X(n),g(!1);return;case"show-model-properties":return u==null?void 0:u(n);case"show-node-properties":return p==null?void 0:p(n);case"show-node-documentation":return h==null?void 0:h(n)}}},[c,d,m,u,p,h]),e=P((o,w)=>{var n,E;(n=z.current)===null||n===void 0||((E=n.contentWindow)===null||E===void 0)||E.postMessage({type:o,data:w},A)},[]);s(()=>(window.addEventListener("message",y),e("ready"),()=>{window.removeEventListener("message",y)}),[y,e]),s(()=>t&&e("change-files",r)||void 0,[e,r,t]),s(()=>t&&e("toggle-attributes",L)||void 0,[e,L,t]),s(()=>t&&e("toggle-initializers",j)||void 0,[e,j,t]),s(()=>t&&e("toggle-names",I)||void 0,[e,I,t]),s(()=>t&&e("toggle-direction",k)||void 0,[e,k,t]),s(()=>t&&e("toggle-theme",U)||void 0,[e,U,t]),F(G,()=>({export(o){e("export",o)},changeGraph(o){e("change-graph",o)},search(o){e("search",o)},select(o){e("select",o)},showModelProperties(){e("show-model-properties")},showNodeDocumentation(o){e("show-node-documentation",o)}}));const O=V(()=>!t||v?i.createElement(ie,null,i.createElement(Q,{size:"60px",color:D})):t&&!b?x:null,[t,v,b,x]);return i.createElement(te,null,O,i.createElement(oe,{show:!v&&b},i.createElement(re,{items:[{icon:"zoom-in",tooltip:f("graph:zoom-in"),onClick:()=>e("zoom-in")},{icon:"zoom-out",tooltip:f("graph:zoom-out"),onClick:()=>e("zoom-out")},{icon:"restore-size",tooltip:f("graph:restore-size"),onClick:()=>e("zoom-reset")}],reversed:!0,tooltipPlacement:"bottom"}),i.createElement(ne,null,i.createElement("iframe",{ref:z,src:`${_}/netron/index.html`,frameBorder:0,scrolling:"no",marginWidth:0,marginHeight:0}),i.createElement("a",{className:"powered-by",href:"https://github.com/lutzroeder/netron",target:"_blank",rel:"noreferrer"},"Powered by ",i.createElement("img",{src:_+S,alt:"netron"})))))});N.displayName="Graph";export default N;
