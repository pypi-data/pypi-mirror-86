import a,{useMemo as h}from"../../../web_modules/react.js";import{contentHeight as p,primaryColor as S,rem as C}from"../../utils/style.js";import I from"../ScatterChart.js";import{divide as R}from"../../resource/high-dimensional/index.js";import j from"../../../web_modules/query-string.js";import g from"../../../web_modules/styled-components.js";import E from"../../hooks/useHeavyWork.js";import{useRunningRequest as k}from"../../hooks/useRequest.js";import{useTranslation as L}from"../../../web_modules/react-i18next.js";import N from"../../utils/wasm.js";const q=()=>N("high_dimensional_divide").then(i=>t=>{var s;return i(t.points,t.labels,!!t.visibility,(s=t.keyword)!==null&&s!==void 0?s:"")}),A=g(I).withConfig({displayName:"HighDimensionalChart__StyledScatterChart",componentId:"sc-179pidq-0"})(["height:",";"],p),v=g.div.withConfig({displayName:"HighDimensionalChart__Empty",componentId:"sc-179pidq-1"})(["display:flex;justify-content:center;align-items:center;font-size:",";height:",";"],C(20),p),y={show:!0,position:"top",formatter:i=>i.data.showing?i.data.name:""},H=({run:i,tag:t,running:s,labelVisibility:l,keyword:d,reduction:_,dimension:m})=>{const{t:c}=L("common"),{data:e,error:f,loading:u}=k(i&&t?`/embedding/embedding?${j.stringify({run:i,tag:t,dimension:Number.parseInt(m,10),reduction:_})}`:null,!!s),w=h(()=>{var n,r;return{points:(n=e==null?void 0:e.embedding)!==null&&n!==void 0?n:[],keyword:d,labels:(r=e==null?void 0:e.labels)!==null&&r!==void 0?r:[],visibility:l}},[e,l,d]),o=E(q,null,R,w),b=h(()=>{var n,r;return[{name:"highlighted",data:(n=o==null?void 0:o[0])!==null&&n!==void 0?n:[],label:y},{name:"others",data:(r=o==null?void 0:o[1])!==null&&r!==void 0?r:[],label:y,color:S}]},[o]);return!e&&f?a.createElement(v,null,c("common:error")):!e&&!u?a.createElement(v,null,c("common:empty")):a.createElement(A,{loading:u,data:b,gl:m==="3d"})};export default H;
