import G,{AsideSection as h}from"../components/Aside.js";import e,{useEffect as Q,useMemo as r,useState as s}from"../../web_modules/react.js";import W from"../components/Select.js";import{em as L,rem as P}from"../utils/style.js";import Y from"../components/Checkbox.js";import z from"../components/Content.js";import K from"../components/Error.js";import p from"../components/Field.js";import M from"../components/HighDimensionalPage/HighDimensionalChart.js";import J from"../components/Icon.js";import T from"../components/RadioButton.js";import k from"../components/RadioGroup.js";import X from"../components/RunningToggle.js";import Z from"../components/SearchInput.js";import ee from"../components/Title.js";import v from"../../web_modules/styled-components.js";import ne from"../hooks/useQuery.js";import{useRunningRequest as te}from"../hooks/useRequest.js";import oe from"../hooks/useSearchValue.js";import{useTranslation as ie}from"../../web_modules/react-i18next.js";const $=["2d","3d"],N=["pca","tsne"],le=v(W).withConfig({displayName:"high-dimensional__StyledSelect",componentId:"kunowy-0"})(["min-width:",";"],L(160)),D=v(J).withConfig({displayName:"high-dimensional__StyledIcon",componentId:"kunowy-1"})(["margin-right:",";vertical-align:middle;"],L(4)),S=v.div.withConfig({displayName:"high-dimensional__AsideTitle",componentId:"kunowy-2"})(["font-size:",";line-height:",";font-weight:700;margin-bottom:",";"],P(16),P(16),P(10)),re=()=>{const{t}=ie(["high-dimensional","common"]),[c,j]=s(!0),{data:_,error:x,loading:E}=te("/embedding/tags",c),o=r(()=>_?_.runs.reduce((n,i,a)=>{var l,m;return[...n,...(l=(m=_.tags[a])===null||m===void 0?void 0:m.map(A=>({run:i,tag:A,label:`${i}/${A}`})))!==null&&l!==void 0?l:[]]},[]):[],[_]),g=r(()=>o.map(n=>n.label),[o]),u=ne(),R=r(()=>{var n,i,a;const l=Array.isArray(u.run)?u.run[0]:u.run;return(n=l&&((i=o.find(m=>m.run===l))===null||i===void 0?void 0:i.label))!==null&&n!==void 0?n:(a=o[0])===null||a===void 0?void 0:a.label},[u.run,o]),[d,w]=s(R);Q(()=>w(R),[R]);const I=r(()=>{var n;return(n=o.find(i=>i.label===d))!==null&&n!==void 0?n:{run:"",tag:"",label:""}},[o,d]),[f,V]=s(""),H=oe(f),[y,O]=s($[0]),[b,q]=s(N[0]),[U,B]=s(!0),C=r(()=>e.createElement(X,{running:c,onToggle:j}),[c,j]),F=r(()=>g.length?e.createElement(G,{bottom:C},e.createElement(h,null,e.createElement(S,null,t("common:select-runs")),e.createElement(le,{list:g,value:d,onChange:w})),e.createElement(h,null,e.createElement(p,null,e.createElement(Z,{placeholder:t("common:search"),value:f,onChange:V})),e.createElement(p,null,e.createElement(Y,{value:U,onChange:B},t("high-dimensional:display-all-label")))),e.createElement(h,null,e.createElement(S,null,e.createElement(D,{type:"dimension"}),t("high-dimensional:dimension")),e.createElement(p,null,e.createElement(k,{value:y,onChange:n=>O(n)},$.map(n=>e.createElement(T,{key:n,value:n},t(n)))))),e.createElement(h,null,e.createElement(S,null,e.createElement(D,{type:"reduction"}),t("high-dimensional:reduction-method")),e.createElement(p,null,e.createElement(k,{value:b,onChange:n=>q(n)},N.map(n=>e.createElement(T,{key:n,value:n},t(n))))))):null,[t,C,y,d,g,U,b,f]);return e.createElement(e.Fragment,null,e.createElement(ee,null,t("common:high-dimensional")),e.createElement(z,{aside:F,loading:E},!E&&!o.length?e.createElement(K,null):x?e.createElement("div",null,t("common:error")):E?null:e.createElement(M,{dimension:y,keyword:H,run:I.run,tag:I.tag,running:c,labelVisibility:U,reduction:b})))};export default re;
