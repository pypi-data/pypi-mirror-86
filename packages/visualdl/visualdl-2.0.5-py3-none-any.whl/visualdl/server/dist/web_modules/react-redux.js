import"./common/_commonjsHelpers-2c0027bd.js";import{r as a}from"./common/index-6f180876.js";import{r as w}from"./common/index-feb68792.js";import"./common/index-f4be0386.js";import"./common/hoist-non-react-statics.cjs-1fb56bd0.js";var c=a.createContext(null);function k(e){e()}var v=k,_=function(t){return v=t},E=function(){return v},x={notify:function(){}};function U(){var e=E(),t=null,r=null;return{clear:function(){t=null,r=null},notify:function(){e(function(){for(var n=t;n;)n.callback(),n=n.next})},get:function(){for(var n=[],i=t;i;)n.push(i),i=i.next;return n},subscribe:function(n){var i=!0,o=r={callback:n,next:null,prev:r};return o.prev?o.prev.next=o:t=o,function(){if(!i||t===null)return;i=!1,o.next?o.next.prev=o.prev:r=o.prev,o.prev?o.prev.next=o.next:t=o.next}}}}var S=function(){function e(r,s){this.store=r,this.parentSub=s,this.unsubscribe=null,this.listeners=x,this.handleChangeWrapper=this.handleChangeWrapper.bind(this)}var t=e.prototype;return t.addNestedSub=function(s){return this.trySubscribe(),this.listeners.subscribe(s)},t.notifyNestedSubs=function(){this.listeners.notify()},t.handleChangeWrapper=function(){this.onStateChange&&this.onStateChange()},t.isSubscribed=function(){return Boolean(this.unsubscribe)},t.trySubscribe=function(){this.unsubscribe||(this.unsubscribe=this.parentSub?this.parentSub.addNestedSub(this.handleChangeWrapper):this.store.subscribe(this.handleChangeWrapper),this.listeners=U())},t.tryUnsubscribe=function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null,this.listeners.clear(),this.listeners=x)},e}();function j(e){var t=e.store,r=e.context,s=e.children,n=a.useMemo(function(){var u=new S(t);return u.onStateChange=u.notifyNestedSubs,{store:t,subscription:u}},[t]),i=a.useMemo(function(){return t.getState()},[t]);a.useEffect(function(){var u=n.subscription;return u.trySubscribe(),i!==t.getState()&&u.notifyNestedSubs(),function(){u.tryUnsubscribe(),u.onStateChange=null}},[n,i]);var o=r||c;return a.createElement(o.Provider,{value:n},s)}var y=typeof window!="undefined"&&typeof window.document!="undefined"&&typeof window.document.createElement!="undefined"?a.useLayoutEffect:a.useEffect;function C(){var e=a.useContext(c);return e}function g(e){e===void 0&&(e=c);var t=e===c?C:function(){return a.useContext(e)};return function(){var s=t(),n=s.store;return n}}var D=g();function P(e){e===void 0&&(e=c);var t=e===c?D:g(e);return function(){var s=t();return s.dispatch}}var A=P(),N=function(t,r){return t===r};function W(e,t,r,s){var n=a.useReducer(function(h){return h+1},0),i=n[1],o=a.useMemo(function(){return new S(r,s)},[r,s]),u=a.useRef(),d=a.useRef(),b=a.useRef(),l=a.useRef(),p=r.getState(),f;try{e!==d.current||p!==b.current||u.current?f=e(p):f=l.current}catch(h){throw u.current&&(h.message+=`
The error may be correlated with this previous error:
`+u.current.stack+`

`),h}return y(function(){d.current=e,b.current=p,l.current=f,u.current=void 0}),y(function(){function h(){try{var m=d.current(r.getState());if(t(m,l.current))return;l.current=m}catch(R){u.current=R}i()}return o.onStateChange=h,o.trySubscribe(),h(),function(){return o.tryUnsubscribe()}},[r,o]),f}function H(e){e===void 0&&(e=c);var t=e===c?C:function(){return a.useContext(e)};return function(s,n){n===void 0&&(n=N);var i=t(),o=i.store,u=i.subscription,d=W(s,n,o,u);return a.useDebugValue(d),d}}var B=H();_(w.unstable_batchedUpdates);export{j as Provider,A as useDispatch,B as useSelector};
