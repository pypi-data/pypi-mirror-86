import fifa
import pandas as pd
roster=["Russia","Saudi Arabia","Egypt","Uruguay","Morocco","Iran","Portugal","Spain","France","Australia","Peru","Denmark","Argentina","Iceland","Croatia","Nigeria","Costa Rica"
,"Serbia","Brazil","Switzerland","Germany","Mexico","Sweden","South Korea","Belgium","England","Tunisia","Panama","Colombia","Japan","Poland","Senegal"]
_columns={"GAMES":[0 for i in range(32)],"WON":[0 for i in range(32)],"LOST":[0 for i in range(32)],"DRAW":[0 for i in range(32)],"GD":[i*0 for i in range(32)],
"POINTS":[0 for i in range(32)],"LEVEL":[1 for i in range(32)],"NAME":roster,"RATE":[3,1,2,4,1,2,4,4,4,1,3,3,4,3,3,1,3,2,4,4,4,3,3,1,4,4,2,1,3,1,3,2]}
table=pd.DataFrame(_columns,index=roster)
g_a=table.head(4)
g_b=table.iloc[4:8]
g_c=table.iloc[8:12]
g_d=table.iloc[12:16]
g_e=table.iloc[16:20]
g_f=table.iloc[20:24]
g_g=table.iloc[24:28]
g_h=table.tail(4)
teams=[]
for i in range(8):
    lista=list(table.iloc[4*i:4*(i+1)]["NAME"])
    teams.append(lista)
z=[[0,5],[1,4],[2,3]]
for unknown in range(2):
    for _p,_q in z:
        fifa.group_game(table,g_a,_p,_q,teams[0],"A")
        fifa.group_game(table,g_b,_p,_q,teams[1],"B")
        fifa.group_game(table,g_c,_p,_q,teams[2],"C")
        fifa.group_game(table,g_d,_p,_q,teams[3],"D")
        fifa.group_game(table,g_e,_p,_q,teams[4],"E")
        fifa.group_game(table,g_f,_p,_q,teams[5],"F")
        fifa.group_game(table,g_g,_p,_q,teams[6],"G")
        fifa.group_game(table,g_h,_p,_q,teams[7],"H")
print("===================================================================================================================================================================================")
print("                  ROUND OF 16")
print("===================================================================================================================================================================================")
print("***********************************")
_16=[[teams[0][0],teams[1][1]],[teams[2][0],teams[3][1]],[teams[4][0],teams[5][1]]
,[teams[6][0],teams[7][1]],[teams[1][0],teams[0][1]],[teams[3][0],teams[2][1]],
[teams[5][0],teams[4][1]],[teams[7][0],teams[6][1]]]
_16_8=[]
fifa.roundof16_game(table,_16,_16_8)
print("===================================================================================================================================================================================")
print("                  QUARTER-FINALS")
print("===================================================================================================================================================================================")
print("***********************************")
print("***********************************")
_8=[[_16_8[2],_16_8[3]],[_16_8[0],_16_8[1]],[_16_8[6],_16_8[7]],[_16_8[4],_16_8[5]]]
_8_4=[]
fifa.quarter_game(table,_8,_8_4)
print("===================================================================================================================================================================================")
print("                   SEMI-FINALS")
print("===================================================================================================================================================================================")
print("***********************************")
print("***********************************")
print("***********************************")
_4=[[_8_4[0],_8_4[1]],[_8_4[2],_8_4[3]]]
_4_2=[]
_3=[]
fifa.semis_game(table,_4,_4_2,_3)
print("===================================================================================================================================================================================")
print("                   THIRD-PLACE-PLAYOFF")
print("===================================================================================================================================================================================")
print("***********************************")
_3_b=[[_3[0],_3[1]]]
fifa.thirdplace_playoff(table,_3_b)
print("===================================================================================================================================================================================")
print("===================================================================================================================================================================================")
print(" "*43,"*")
for i in range(3):
    print(" "*(42-i),"*"," "*(2*i-1),"*")
print(" "*39,"*","FINAL  *")
for i in range(2,-1,-1):
    print(" "*(42-i),"*"," "*(2*i-1),"*")
print(" "*43,"*")
print("===================================================================================================================================================================================")
_2=[[_4_2[0],_4_2[1]]]
fifa.final_game(table,_2)
print("                                                TABLE")
print("\n")
table.sort_values(["LEVEL","WON","POINTS","GD","RATE"],inplace=True,ascending=False)
print(table.loc[:,"GAMES":"LEVEL"])
print("===================================================================================================================================================================================")
print("                                                           THE END")
